cmake_minimum_required(VERSION 3.30)
project(h24w_23)

set(CMAKE_CXX_STANDARD 23)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

macro(create_executable files)
    set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/bin)

    set(srcs ${ARGV})
    foreach (src ${srcs})
        if (src MATCHES ".*\\.(cpp|c|cc|cxx|h|hpp)$")
            list(APPEND src_list ${src})
        endif ()
        if (src MATCHES ".*\\.(hlsl|hlsli)$")
            file(COPY ${src} DESTINATION ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/shaders)
        endif ()
        if (LOCAL_BUILD)
            if (src MATCHES ".*\\.(fbx|png|hdr|efkefc)$")
                file(COPY ${src} DESTINATION ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
            endif ()
        endif ()
    endforeach ()

    add_executable(h24w_23 WIN32 ${src_list})
    target_include_directories(h24w_23 PRIVATE include)
    target_include_directories(h24w_23 PRIVATE ThirdParty/aqua-engine-0.1.1/include)
    target_include_directories(h24w_23 PRIVATE $ENV{FBXSDK_DIR}/include)
    target_link_libraries(h24w_23 PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/ThirdParty/aqua-engine-0.1.1/lib/aqua-engine.lib)
    target_link_libraries(h24w_23 PRIVATE d2d1.lib)
    target_link_libraries(h24w_23 PRIVATE dwrite.lib)
    target_link_libraries(h24w_23 PRIVATE d3d12.lib)
    target_link_libraries(h24w_23 PRIVATE dxgi.lib)
    target_link_libraries(h24w_23 PRIVATE d3dcompiler.lib)
    target_link_libraries(h24w_23 PUBLIC $ENV{FBXSDK_DIR}/lib/x64/debug/libfbxsdk-md.lib)
    target_link_libraries(h24w_23 PUBLIC $ENV{FBXSDK_DIR}/lib/x64/debug/libxml2-md.lib)
    target_link_libraries(h24w_23 PUBLIC $ENV{FBXSDK_DIR}/lib/x64/debug/zlib-md.lib)
endmacro()

set(src_files src/main.cpp)

create_executable(${src_files})
